
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">

    <title>Andaman7 Developer Portal - A7 Protocol</title>
    
    <meta name="author" content="Pierre-Yves Derbaix">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="shortcut icon" href="http://a7-software.github.io/andaman7-api/assets/themes/andaman7/images/favicon.ico" type="image/vnd.microsoft.icon" />

    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css">
    <link rel="stylesheet" href="//cdn.datatables.net/1.10.10/css/dataTables.bootstrap.min.css">
    <link rel="stylesheet" href="//cdn.datatables.net/fixedheader/3.1.0/css/fixedHeader.bootstrap.min.css">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/metisMenu/1.1.3/metisMenu.min.css">
    <link href="http://a7-software.github.io/andaman7-api/assets/themes/andaman7/resources/sb-admin/css/sb-admin-2.css" rel="stylesheet">
    <link href="http://a7-software.github.io/andaman7-api/assets/themes/andaman7/css/style.css" rel="stylesheet">
    <link href="http://a7-software.github.io/andaman7-api/assets/themes/andaman7/css/syntax.css" rel="stylesheet">
    <link href="http://a7-software.github.io/andaman7-api/assets/themes/andaman7/resources/font-awesome/css/font-awesome.min.css" rel="stylesheet">
    <link href="http://fonts.googleapis.com/css?family=Lato:300,400,700,300italic,400italic,700italic" rel="stylesheet" type="text/css">

    

    <!--[if lt IE 9]>
    <script src="http://a7-software.github.io/andaman7-api/assets/themes//resources/respond/Respond.min.js"></script>
    <![endif]-->

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.11.0/jquery-ui.min.js"></script>
    <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/metisMenu/2.0.0/metisMenu.min.js"></script>
    <script src="http://a7-software.github.io/andaman7-api/assets/themes/andaman7/resources/sb-admin/js/sb-admin-2.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/underscore.js/1.5.2/underscore-min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/floatthead/1.3.1/jquery.floatThead-slim.min.js"></script>
    <script src="http://a7-software.github.io/andaman7-api/assets/themes/andaman7/resources/jiko/jiko.js" type="text/javascript"></script>
    <script src="http://a7-software.github.io/andaman7-api/assets/themes/andaman7/resources/jekyll-table-of-contents/toc.js" type="text/javascript"></script>
    <script src="https://cdn.datatables.net/1.10.10/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.10.10/js/dataTables.bootstrap.min.js"></script>
    <script src="https://cdn.datatables.net/fixedheader/3.1.0/js/dataTables.fixedHeader.min.js"></script>
    <script src="http://a7-software.github.io/andaman7-api/assets/themes/andaman7/js/crypto-js/crypto-js.js"></script>
    <script src="http://a7-software.github.io/andaman7-api/assets/themes/andaman7/js/utils.js"></script>

    <script src='https://www.google.com/recaptcha/api.js'></script>
</head>

<body>

<div id="wrapper">
    <nav class="navbar navbar-default navbar-static-top" role="navigation" style="margin-bottom: 0">
    <div class="navbar-header">
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="/"></a>
    </div>
    <!-- /.navbar-header -->

    <div class="navbar-default sidebar" role="navigation">
        <div class="sidebar-nav navbar-collapse">
            
<ul class="nav" id="side-menu">
    
    <li>
        <a href="http://a7-software.github.io/andaman7-api/a7-protocol.html" >
            <i class="fa fa-cogs fa-fw"></i> 
            A7 Protocol
            
        </a>
        
    </li>
    
    <li>
        <a href="http://a7-software.github.io/andaman7-api/getting-started.html" >
            <i class="fa fa-play-circle fa-fw"></i> 
            Getting started
            
        </a>
        
    </li>
    
    <li>
        <a href="#" >
            <i class="fa fa-book fa-fw"></i> 
            Developer's guide
            
            <span class="fa arrow"></span>
            
        </a>
        
        <ul class="nav nav-second-level collapse">
            
            
<li>
    <a href="http://a7-software.github.io/andaman7-api/guide/overview.html">
        <i class="fa fa-newspaper-o fa-fw"></i> 
        Overview
        
    </a>
    
</li>

<li>
    <a href="http://a7-software.github.io/andaman7-api/guide/basics.html">
        <i class="fa fa-puzzle-piece fa-fw"></i> 
        Basics
        
    </a>
    
</li>

<li>
    <a href="#">
        <i class="fa fa-stethoscope fa-fw"></i> 
        Medical data
        
        <span class="fa arrow"></span>
        
    </a>
    
    <ul class="nav nav-third-level collapse">
        
<li>
    <a href="http://a7-software.github.io/andaman7-api/guide/medical-data/types.html">
        <i class="fa fa-file-code-o fa-fw"></i> 
        Types
        
    </a>
    
</li>

<li>
    <a href="http://a7-software.github.io/andaman7-api/guide/medical-data/synchronization.html">
        <i class="fa fa-refresh fa-fw"></i> 
        Synchronization
        
    </a>
    
</li>

    </ul>
    
</li>

<li>
    <a href="http://a7-software.github.io/andaman7-api/guide/errors.html">
        <i class="fa fa-exclamation-circle fa-fw"></i> 
        Errors
        
    </a>
    
</li>

            
        </ul>
        
    </li>
    
    <li>
        <a href="https://sandbox.andaman7.com/swagger/index.html" target="_blank">
            <i class="fa fa-flask fa-fw"></i> 
            Swagger console
            
        </a>
        
    </li>
    
    <li>
        <a href="http://a7-software.github.io/andaman7-api/code-samples.html" >
            <i class="fa fa-code fa-fw"></i> 
            Code samples
            
        </a>
        
    </li>
    
    <li>
        <a href="http://a7-software.github.io/andaman7-api/forum.html" >
            <i class="fa fa-comment fa-fw"></i> 
            Developer forum
            
        </a>
        
    </li>
    
    <li>
        <a href="https://github.com/andaman7" target="_blank">
            <i class="fa fa-github fa-fw"></i> 
            GitHub
            
        </a>
        
    </li>
    
    <li>
        <a href="https://twitter.com/andaman7" target="_blank">
            <i class="fa fa-twitter fa-fw"></i> 
            Twitter
            
        </a>
        
    </li>
    
    <li>
        <a href="https://www.facebook.com/Andaman7App" target="_blank">
            <i class="fa fa-facebook fa-fw"></i> 
            Facebook
            
        </a>
        
    </li>
    
    <li>
        <a href="https://www.linkedin.com/company/andaman7" target="_blank">
            <i class="fa fa-linkedin fa-fw"></i> 
            LinkedIn
            
        </a>
        
    </li>
    
</ul>
        </div>
        <!-- /.sidebar-collapse -->
    </div>
    <!-- /.navbar-static-side -->
</nav>


    <div id="page-wrapper">
        <div class="row">
            <div class="alert alert-warning alert-dismissible" role="alert">
                <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <strong>Warning!</strong> Please note that this document is a first draft and is likely to change shortly.
            </div>
        
<div class="page-header">
    <h1>A7 Protocol </h1>
</div>


<div id="toc"></div>

<h2 id="what-is-the-a7-protocol-">What is the A7 protocol ?</h2>
<hr />
<p>The A7 protocol is an attempt to simplify the exchange of medical information while being as much compatible with the current standards as possible. <br />
We don’t want to reinvent the wheel, but the wheel must be easy to use !</p>

<p>A7 defines both an exchange protocol and a very simple, basic, data structure. It is model dependent (medical domain), but also as generic as possible. <br />
We believe that genericity bring simplicity. A7 is inspired by the works of <a href="https://www.hl7.org/fhir/" target="_blank"><em>FHIR</em></a>, <a href="https://www.hl7.org/" target="_blank"><em>HL7</em></a>, <a href="http://cordis.europa.eu/project/rcn/17093_en.html" target="_blank"><em>GEHR</em></a>, <a href="http://www.openehr.org/home" target="_blank"><em>OpenEHR</em></a>…<br />
and our own 25 years of experience in the medical sector (we developed prevention focused EHR and secure medical messaging systems).</p>

<h2 id="why-another-protocol-">Why another protocol ?</h2>
<hr />

<p>Well, because we need it, HL7 has many qualities but for some lightweight use cases, it’s much too complex to use. <br />
FHIR is an excellent step in the right direction. As James Agnew says “Apps are becoming a new reality - No suitable standards exist”.<br />
But the full FHIR, while excellent, is still very wide in scope. We need a very simple and basic protocol for medical apps.</p>

<h2 id="why-this-name-">Why this name ?</h2>
<hr />

<p>The name comes from 2 sources, actually.  Initially, it was a shorthand for our Andaman7 project<br />
(mobile applications for EHR and PHR plus the platform to connect them).<br />
But James Agnew’s mention of the new reality of “Apps” could bring a new, wider meaning: A7 is the protocol for lightweight Apps exchanging medical information.</p>

<p>A7 is to Apps what HL7 is to HIS (Hospital Information Systems).</p>

<h2 id="can-i-use-it---license-">Can I use it ?  License ?</h2>
<hr />

<p>We have no “world dominance” hopes for our A7 protocol. We just needed a protocol for our own use so we created it.<br />
However if you like it and if it could be useful to you, feel free to use it.<br />
It’s licensed under the Creative Commons - Attribution 4.0 International (CC BY 4.0).</p>

<h2 id="what-are-the-basic-concepts-of-the-data-model-">What are the basic concepts of the data model ?</h2>
<hr />

<p>We define concepts at 2 levels :</p>

<ul>
  <li><strong>domain</strong> concepts (aka business concepts)</li>
  <li><strong>interface</strong> concepts (aka API concepts)</li>
</ul>

<h3 id="domain-concepts">Domain concepts</h3>

<p>Our objective being to be very simple and efficient, we currently only have 3 main concepts (not counting secondary concepts):</p>

<ul>
  <li>AMI - Atomic Medical Item</li>
  <li>Qualifier</li>
  <li>AMISet</li>
</ul>

<p>Those concepts are grouped in <a href="http://a7-software.github.io/andaman7-api/guide/medical-data/types.html">static dictionaries</a> created by Andaman7.<br />
Of course they can evolve according to users needs.</p>

<h4 id="ami">AMI</h4>
<p>An AMI - Atomic Medical Item is the most basic piece of information. <br />
It’s “atomic” meaning it can’t be broken down to a simpler concept.</p>

<p>Examples are the weight of a person, an allergy or a red blood cell count.  But we are a bit extreme too and like genericity. <br />
So the last name is also an AMI, as well as the phone number, any image that is part of the medical file, an URL to medical information online.</p>

<p>An AMI is basically a key-value pair augmented with :</p>

<ul>
  <li>the source of the information - the person and the device that is creating the piece of info (a doctor, a patient, a lab machine, a hospital…)</li>
  <li>a timestamp of when the information was created</li>
</ul>

<p>AMIs are universally unique (we give them a <a href="https://en.wikipedia.org/wiki/Universally_unique_identifier">UUID</a> by the way).<br />
Given the fact that they are a combination of key, value, source and timestamp, it’s very natural that they are unique.<br />
AMIs can never be modified.  There is no need to modify an AMI. <br />
If you want to enter a new value for weight, you just create an new AMI (a new combination of key, value, source and timestamp). <br />
The only “modification” to an AMI is the capability to “invalidate” it. <br />
This is necessary if, after some time, one realises that the previously created AMI was a mistake somehow<br />
(if the medical condition is not valid anymore, we have other mechanisms for that, based on start date and end date qualifiers).</p>

<p>These constraints make AMIs very easy to manage in a distributed world.  They can be created anywhere, by anyone, with no risk of “data conflict” whatsoever.<br />
AMIs have a reference to their “parent”, e.g. a given EHR.</p>

<p>For example, in Andaman7, the weight is represented by an AMI with the <code>ami.weight</code> key. Its value is the number representing the actual weight.<br />
You may wondering “How do I know the unit of this value ?”. Well, this is covered in the next concept, the qualifiers.</p>

<p>The list of all defined AMIs is available at: <a href="http://a7-software.github.io/andaman7-api/guide/medical-data/types.html#amis">AMIs dictionary</a>.  We can create new ones if needed;<br />
please contact us at <a href="mailto:support@andaman7.com">support@andaman7.com</a>.</p>

<p>Some AMIs’ values are restricted to a predefined list of values.  Those lists and values are listed in the <a href="http://a7-software.github.io/andaman7-api/guide/medical-data/types.html#amis">AMIs dictionary</a> page.</p>

<h4 id="qualifier">Qualifier</h4>

<p>Life is not so simple, unfortunately. Very often, a piece of information needs to be “qualified” by secondary elements of information.</p>

<p>Examples are :</p>

<ul>
  <li>the unit of measurement of the weight must be specified - we use a qualifier “unit” for that</li>
  <li>a medical condition is valid at a given time - we use a qualifier to specify the date (or period with two qualifiers “Start date” and “End date”); note that this is independent from the creation date of the AMI</li>
  <li>a family antecedent of diabetes (= an AMI) is further qualified by a “relationship” qualifier : the “mother” was diabetic</li>
</ul>

<p>For the sake of simplicity and genericity, qualifiers are also a combination of key, value, source and timestamp.<br />
Qualifiers have a reference to their “parent”, e.g. an AMI.</p>

<p>An example of qualifier is the unit of an AMI of type <code>ami.weight</code>. The unit is identified by the <code>qualifier.unit</code> key.</p>

<p>In Andaman7, you can also manage documents. Those documents are represented by AMIs whose key starts with <code>ami.document</code>.<br />
When dealing with files, it is generally useful to indicate their MIME types. This can be done by adding a <code>qualifier.mimetype</code> qualifier to those document AMIs.</p>

<p>Some qualifiers’ values are restricted to a predefined list of values. Those lists and values are listed in the <a href="http://a7-software.github.io/andaman7-api/guide/medical-data/types.html#amis">AMIs and Qualifiers dictionary</a> page. We can create new ones if needed;<br />
please contact us at <a href="mailto:support@andaman7.com">support@andaman7.com</a>.</p>

<h4 id="amiset">AMISet</h4>

<p>AMIs usually need to be grouped together. For this we use the notion of AMISet, which is a set, or group of AMIs.</p>

<p>Examples are:</p>

<ul>
  <li>an EHR is an AMISet identified by <code>amiSet.ehr</code> - because it groups all AMIs of a given patient</li>
  <li>a consultation / visit is an AMISet - because it groups AMIs (weight, temperature, complaints…) created during the same event</li>
</ul>

<p>Like Qualifiers, AMISets are also a combination of key, value, source and timestamp.</p>

<p>The list of all defined AMISets is available at: <a href="http://a7-software.github.io/andaman7-api/guide/medical-data/types.html#ami-sets">AMISets dictionary</a>.  We can create new ones if needed;<br />
please contact us at <a href="mailto:support@andaman7.com">support@andaman7.com</a>.</p>

<p>Voilà, that’s all there is to it! Simple, no?  Now, how do we exchange those 3 simple domain concepts in our API?</p>

<h3 id="interface-concepts">Interface concepts</h3>

<p>Interface concepts are important because they are at the basis of the APIs between systems.  API methods directly manipulate interface concepts.</p>

<p>We tried to be even more generic here, so we were a bit more extreme : all three domain concepts above<br />
(AMI, Qualifier, AMISet) are defined in a common data structure at interface level.</p>

<p>We created an <strong>A7 Item</strong>, which is a “sourced, identified, dated key value pair”. It contains:</p>

<ul>
  <li>a key (an exhaustive list of AMIs, Qualifiers or AMISets keys can be found <a href="http://a7-software.github.io/andaman7-api/guide/medical-data/types.html">here</a>)</li>
  <li>a value</li>
  <li>a source</li>
  <li>a date (timestamp)</li>
  <li>a unique identifier</li>
  <li>a parent</li>
</ul>

<p>An example:</p>

<ul>
  <li>key = <code>ami.weight</code></li>
  <li>value = <code>70</code></li>
  <li>source = <code>de305d54-75b4-431b-adb2-eb6b9e546014</code> (the UUID of the person or machine at the source of the information)</li>
  <li>date = <code>2015-04-14T18:54:07Z</code></li>
  <li>identifier = <code>123e4567-e89b-12d3-a456-426655440000</code> (often a UUID)</li>
  <li>parent = <code>43722d40-e381-11e4-9612-0002a5d5c51b</code> (the UUID of the parent A7 Item)</li>
</ul>

<h3 id="implementation-concepts">Implementation concepts</h3>

<p>Implementation concepts are left to you.<br />
You can implement the domain/interface concepts as you want, taking into account other objectives like performance, storage efficiency, etc.</p>

<h2 id="how-does-it-look-like-in-practice--a-sample-api-call">How does it look like in practice ? A sample API call.</h2>

<p>First, we will send an AMI in order to update the weight of a user.<br />
It can be done by sending a <code>POST</code> HTTP request to  <code>https://sandbox.andaman7.com/public/v1/users/{userId}/a7-items</code>.<br />
The <code>{userId}</code> path parameter must be replaced by the identifier of the Andaman7 user to whom you want to send the A7 items.</p>

<p>Here is the structure of the A7 item of the AMI :</p>

<div class="highlight"><pre><code class="language-json"><span class="p">{</span>  
    <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;8ef93cb2-d4f0-4067-8957-c0b2d72d62de&quot;</span><span class="p">,</span>
    <span class="nt">&quot;creationDate&quot;</span><span class="p">:</span> <span class="s2">&quot;2015-06-24T14:06:48.206+0000&quot;</span><span class="p">,</span>
    <span class="nt">&quot;creatorDeviceId&quot;</span><span class="p">:</span> <span class="s2">&quot;e8015cdc-a05f-487c-9ae3-6f89093cc7a3&quot;</span><span class="p">,</span>
    <span class="nt">&quot;invalidationDate&quot;</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
    <span class="nt">&quot;invalidatorDeviceId&quot;</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
    <span class="nt">&quot;creatorUserId&quot;</span><span class="p">:</span> <span class="s2">&quot;908e8b39-5aae-44df-95e2-79a8bfe9e376&quot;</span><span class="p">,</span>
    <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;AMI&quot;</span><span class="p">,</span>
    <span class="nt">&quot;key&quot;</span><span class="p">:</span> <span class="s2">&quot;ami.weight&quot;</span><span class="p">,</span>
    <span class="nt">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;75&quot;</span><span class="p">,</span>
    <span class="nt">&quot;version&quot;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
    <span class="nt">&quot;uuidMulti&quot;</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
    <span class="nt">&quot;parentId&quot;</span><span class="p">:</span> <span class="s2">&quot;fd13fa08-43d2-494b-8890-ad8907cc2fe4&quot;</span>
<span class="p">}</span></code></pre></div>

<p>The body of the HTTP request contains the following JSON object.<br />
The <code>a7Items</code> field contains the list of all A7 items to be sent, like the previous one.<br />
This list must be encoded into a string because this field is encrypted in the secure version.</p>

<div class="highlight"><pre><code class="language-json"><span class="p">{</span>  
    <span class="nt">&quot;sourceDeviceId&quot;</span><span class="p">:</span> <span class="s2">&quot;d5736213-9e26-4c9d-a1ea-8b0873aa1282&quot;</span><span class="p">,</span>
    <span class="nt">&quot;a7Items&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;A7_ITEMS_LIST&gt;&quot;</span>
<span class="p">}</span></code></pre></div>

<p>The receiver can now retrieve those A7 items by sending a <code>GET</code> request to <code>https://sandbox.andaman7.com/public/v1/users/{userId}/a7-items?_deviceId={deviceId}</code>.<br />
The <code>{deviceId}</code> query parameter must be replaced by the identifier of the device which fetches the A7 items.</p>

<p>Check <a href="http://a7-software.github.io/andaman7-api/endpoints/a7-items.html">this page</a> for more information about the API calls related to A7 items.</p>

<p>Continue by reading the <a href="http://a7-software.github.io/andaman7-api/getting-started.html">Getting Started</a> section.</p>

<script type="text/javascript">

    $(document).ready(function() {
    
        $('#toc').toc({
            title: '<h2>Contents</h2><hr/>',
            listType: 'ul'
        });
    });
    
</script>


<hr/>



  <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_developer = 1;
    var disqus_shortname = 'andaman7-dev'; // required: replace example with your forum shortname
    
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>





        </div>
    </div>

    <footer class="footer">
    <div class="container">
        <p class="text-muted">&copy; <a href="http://www.a7-software.com/">A7-Software</a> 2015 - Powered by <a href="http://jekyllrb.com/">Jekyll</a></p>
    </div>
</footer>
</div>




  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-55631137-2', 'auto');
  ga('send', 'pageview');

</script>






</body>
</html>

